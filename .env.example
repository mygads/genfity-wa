# ===================================================================================
# WHATSAPP API (GENFITY-WA) - ENVIRONMENT CONFIGURATION
# ===================================================================================
#
# WhatsApp Web API menggunakan whatsmeow library
# Supports multiple sessions, webhooks, dan message handling
#
# USAGE:
#   cp .env.example .env
#   # Edit .env with your values
#   docker compose up -d --build
#
# IMPORTANT:
#   - All values MUST be set, no default values in docker-compose!
#   - NEVER commit .env to git!
#
# ===================================================================================

# ==================== ENVIRONMENT ====================
GIN_MODE=release
LOG_LEVEL=info

# ==================== IMAGE TAG (for Swarm only) ====================
IMAGE_TAG=latest

# ==================== DATABASE (PostgreSQL) ====================
# Database is in containers/database/ (external via infra-network)
# Database name: wa_api (created in init/01-init-databases.sql)
DB_HOST=infra-postgres
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_postgres_password_here
DB_NAME=wa_api
DB_SSLMODE=disable

# ==================== APPLICATION ====================
PORT=8080
TZ=Asia/Jakarta

# ==================== AUTHENTICATION ====================
# Admin token untuk API access (wajib)
# Generate: openssl rand -base64 32
WA_ADMIN_TOKEN=your_secure_admin_token_here

# ==================== SECURITY / ENCRYPTION ====================
# Encryption key for sensitive data (32 bytes for AES-256)
# Generate: openssl rand -base64 32 | cut -c1-32
# PENTING: Simpan key ini! Data akan hilang jika key berubah
WA_GLOBAL_ENCRYPTION_KEY=your_32_byte_encryption_key_here

# HMAC Key for webhook signature verification (min 32 characters)
# Optional: Untuk memverifikasi webhook authenticity
WA_GLOBAL_HMAC_KEY=your_hmac_key_min_32_characters_here

# ==================== WEBHOOK ====================
# Global webhook URL - semua events dikirim ke sini
# Optional: Bisa diset per-session via API
WA_GLOBAL_WEBHOOK=http://wa-support:8082/webhook/wa
WEBHOOK_FORMAT=json

# ==================== SESSION ====================
# Device name yang muncul di WhatsApp
SESSION_DEVICE_NAME=your_device_name

# ==================== RABBITMQ (Optional) ====================
# Enable event distribution via RabbitMQ
# Format: amqp://user:password@host:port/vhost
RABBITMQ_URL=amqp://admin:your_password@rabbitmq:5672/
RABBITMQ_QUEUE=whatsapp_events

# ==================== WEBHOOK RETRY (Optional) ====================
# WEBHOOK_RETRY_ENABLED=true
# WEBHOOK_RETRY_COUNT=3
# WEBHOOK_RETRY_DELAY_SECONDS=5
# WEBHOOK_ERROR_QUEUE_NAME=webhook_errors
